---
  # -name: Transfer to unknown account "msg": "Couldn't find account: new_account.account_details.id."
  - name: Create a new account 
    community.lbry.lbry_account:
      name: account_to_transfer_to
      state: present
      debug: yes
    register: new_account

  #- name: Check account balance - default account - TODO new module?
  #- name: Check account balance - new_account - TODO new module?

  - name: Set account_id 
    set_fact:
      new_account_id: "{{ new_account.account_details.id }}"  # TODO DO I actually need an address for the account? Probably

  - name: Transfer everything from the default account
    community.lbry.lbry_account_fund:
      to_account: "{{ new_account_id }}"
      everything: yes
    register: transfer

  - assert:
      that:
        - "transfer.changed"
        - "transfer.result.inputs | length > 100"
        - "transfer.result.inputs.0.amount == '1.0'"
        - "transfer.result.total_input == '200.0'"

  - debug:
      var: transfer

  #- name: Check account balance - default account - TODO new module?
  #- name: Check account balance - new_account - TODO new module?

  
