---
  - name: Get all addresses - quote a few are generated by default
    community.lbry.lbry_address_list:
    register: addresses

  - name: We should only have the one address
    assert:
      that:
        - "{{ addresses.addresses | length }} > 10"

  - name: Count addresses
    set_fact:
      address_count: "{{ addresses.addresses | length }}"

  - name: Create another address
    community.lbry.lbry_address_unused:

  - name: Get the list of addresses
    community.lbry.lbry_address_list:
    register: addresses

  - name: Valid that the new address has been added
    assert:
      that:
        - "{{ addresses.addresses | length }} == {{ addresses.addresses | length | int + 1 }}"
        - "addresses.addresses.0.account is defined"
        - "addresses.addresses.0.address is defined"
        - "addresses.addresses.0.pubkey is defined"
        - "addresses.addresses.0.used_times == 0"

  
